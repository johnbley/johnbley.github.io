<html>
<script>
!function(){"use strict";var t=new(function(){function t(t){this._currentContext=t?new Map(t):new Map}return t.prototype.getValue=function(t){return this._currentContext.get(t)},t.prototype.setValue=function(e,r){var n=new t(this._currentContext);return n._currentContext.set(e,r),n},t.prototype.deleteValue=function(e){var r=new t(this._currentContext);return r._currentContext.delete(e),r},t}());function e(t){return Symbol.for(t)}var r=function(){function e(){}return e.prototype.active=function(){return t},e.prototype.with=function(t,e){return e()},e.prototype.bind=function(t,e){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),n=e("OpenTelemetry Context Key ACTIVE_SPAN"),o=e("OpenTelemetry Context Key SUPPRESS_INSTRUMENTATION");function i(t){return t.getValue(n)||void 0}function a(t,e){return t.setValue(n,e)}function s(t){var e;return null===(e=i(t))||void 0===e?void 0:e.context()}function u(t){return t.setValue(o,!0)}var c,p,h={get:function(t,e){if(null!=t)return t[e]},keys:function(t){return null==t?[]:Object.keys(t)}},f={set:function(t,e,r){null!=t&&(t[e]=r)}},d=new(function(){function t(){}return t.prototype.inject=function(t,e){},t.prototype.extract=function(t,e){return t},t.prototype.fields=function(){return[]},t}());!function(t){t[t.NO_PROPAGATION=0]="NO_PROPAGATION",t[t.UNLIMITED_PROPAGATION=-1]="UNLIMITED_PROPAGATION"}(c||(c={})),function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"}(p||(p={}));var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function _(t,e){function r(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var v,g=function(){function t(){}return t.prototype.createValueRecorder=function(t,e){return A},t.prototype.createCounter=function(t,e){return O},t.prototype.createUpDownCounter=function(t,e){return O},t.prototype.createValueObserver=function(t,e,r){return C},t.prototype.createBatchObserver=function(t,e){return L},t}(),m=function(){function t(t){this._instrument=t}return t.prototype.bind=function(t){return this._instrument},t.prototype.unbind=function(t){},t.prototype.clear=function(){},t}(),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.add=function(t,e){this.bind(e).add(t)},e}(m),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.record=function(t,e){this.bind(e).record(t)},e}(m),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.observation=function(){return{observer:this,value:0}},e}(m),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(m),w=function(){function t(){}return t.prototype.add=function(t){},t}(),b=function(){function t(){}return t.prototype.record=function(t,e,r){},t}(),R=function(){function t(){}return t.prototype.update=function(t){},t}(),N=new g,O=new E(new w),A=new y(new b),P=new R,C=new T(P),L=(new T(P),new T(P),new S),D=new(function(){function t(){}return t.prototype.getMeter=function(t,e){return N},t}());!function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"}(v||(v={}));var k=/^([0-9a-f]{32})$/i,M=/^[0-9a-f]{16}$/i,x="0000000000000000",I="00000000000000000000000000000000",U={traceId:I,spanId:x,traceFlags:v.NONE};function H(t){return r=t.traceId,k.test(r)&&r!==I&&(e=t.spanId,M.test(e)&&e!==x);var e,r}var j=function(){function t(t){void 0===t&&(t=U),this._spanContext=t}return t.prototype.context=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),F=new j;var V,G,B,z=new(function(){function t(){}return t.prototype.getCurrentSpan=function(){return F},t.prototype.startSpan=function(t,e,r){var n;if(Boolean(null==e?void 0:e.root))return F;var o,a=r&&(null===(n=i(r))||void 0===n?void 0:n.context());return"object"==typeof(o=a)&&"string"==typeof o.spanId&&"string"==typeof o.traceId&&"number"==typeof o.traceFlags&&H(a)?new j(a):F},t.prototype.withSpan=function(t,e){return e()},t.prototype.bind=function(t,e){return t},t}()),q=new(function(){function t(){}return t.prototype.getTracer=function(t,e){return z},t}()),W=function(){function t(t,e,r){this._provider=t,this.name=e,this.version=r}return t.prototype.getCurrentSpan=function(){return this._getTracer().getCurrentSpan()},t.prototype.startSpan=function(t,e){return this._getTracer().startSpan(t,e)},t.prototype.withSpan=function(t,e){return this._getTracer().withSpan(t,e)},t.prototype.bind=function(t,e){return this._getTracer().bind(t,e)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version);return t?(this._delegate=t,this._delegate):z},t}(),Z=function(){function t(){}return t.prototype.getTracer=function(t,e){var r;return null!==(r=this.getDelegateTracer(t,e))&&void 0!==r?r:new W(this,t,e)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:q},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(t,e)},t}();!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(V||(V={})),function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"}(G||(G={})),function(t){t[t.OK=0]="OK",t[t.UNSET=1]="UNSET",t[t.ERROR=2]="ERROR"}(B||(B={}));var K="object"==typeof globalThis?globalThis:window,X=Symbol.for("io.opentelemetry.js.api.context"),Y=Symbol.for("io.opentelemetry.js.api.metrics"),$=Symbol.for("io.opentelemetry.js.api.propagation"),J=Symbol.for("io.opentelemetry.js.api.trace"),Q=K;function tt(t,e,r){return function(n){return n===t?e:r}}var et,rt=new r,nt=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return Q[X]?this._getContextManager():(Q[X]=tt(2,t,rt),t)},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e){return this._getContextManager().with(t,e)},t.prototype.bind=function(t,e){return void 0===e&&(e=this.active()),this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){var t,e;return null!==(e=null===(t=Q[X])||void 0===t?void 0:t.call(Q,2))&&void 0!==e?e:rt},t.prototype.disable=function(){this._getContextManager().disable(),delete Q[X]},t}(),ot=function(){function t(){this._proxyTracerProvider=new Z,this.isSpanContextValid=H}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){return Q[J]||(this._proxyTracerProvider.setDelegate(t),Q[J]=tt(2,this._proxyTracerProvider,q)),this.getTracerProvider()},t.prototype.getTracerProvider=function(){var t,e;return null!==(e=null===(t=Q[J])||void 0===t?void 0:t.call(Q,2))&&void 0!==e?e:this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){delete Q[J],this._proxyTracerProvider=new Z},t}(),it=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(t){return Q[Y]?this.getMeterProvider():(Q[Y]=tt(2,t,D),t)},t.prototype.getMeterProvider=function(){var t,e;return null!==(e=null===(t=Q[Y])||void 0===t?void 0:t.call(Q,2))&&void 0!==e?e:D},t.prototype.getMeter=function(t,e){return this.getMeterProvider().getMeter(t,e)},t.prototype.disable=function(){delete Q[Y]},t}(),at=nt.getInstance(),st=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(t){return Q[$]?this._getGlobalPropagator():(Q[$]=tt(2,t,d),t)},t.prototype.inject=function(t,e,r){return void 0===e&&(e=f),void 0===r&&(r=at.active()),this._getGlobalPropagator().inject(r,t,e)},t.prototype.extract=function(t,e,r){return void 0===e&&(e=h),void 0===r&&(r=at.active()),this._getGlobalPropagator().extract(r,t,e)},t.prototype.disable=function(){delete Q[$]},t.prototype._getGlobalPropagator=function(){var t,e;return null!==(e=null===(t=Q[$])||void 0===t?void 0:t.call(Q,2))&&void 0!==e?e:d},t}(),ut=nt.getInstance(),ct=ot.getInstance(),pt=(it.getInstance(),st.getInstance());function ht(t){return null==t||(Array.isArray(t)?function(t){for(var e,r=0,n=t;r<n.length;r++){var o=n[r];if(null!=o){if(!e){if(ft(o)){e=typeof o;continue}return!1}if(typeof o!==e)return!1}}return!0}(t):ft(t))}function ft(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}!function(t){t[t.ERROR=0]="ERROR",t[t.WARN=1]="WARN",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG"}(et||(et={}));var dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.enable=function(t,e,r,n){return this._moduleExports=t,this._tracer=e.getTracer(this._tracerName,this._tracerVersion),this._logger=r,n&&(this._config=n),this.patch()},e}(function(){function t(t,e){this._tracerName=t,this._tracerVersion=e}return t.prototype.disable=function(){this.unpatch()},t}()),lt=["OTEL_SAMPLING_PROBABILITY"],_t={OTEL_NO_PATCH_MODULES:"",OTEL_LOG_LEVEL:et.INFO,OTEL_SAMPLING_PROBABILITY:1};function vt(t,e,r,n,o){if(void 0===n&&(n=-1/0),void 0===o&&(o=1/0),void 0!==r[t]){var i=Number(r[t]);!isNaN(i)&&i>=n&&i<=o&&(e[t]=i)}}function gt(t,e,r){var n=r[t];switch("string"==typeof n?n.toUpperCase():n){case"DEBUG":e[t]=et.DEBUG;break;case"INFO":e[t]=et.INFO;break;case"WARN":e[t]=et.WARN;break;case"ERROR":e[t]=et.ERROR}}function mt(){var t=function(t){var e={};for(var r in _t){var n=r;switch(n){case"OTEL_SAMPLING_PROBABILITY":vt(n,e,t,0,1);break;case"OTEL_LOG_LEVEL":gt(n,e,t);break;default:lt.indexOf(n)>=0?vt(n,e,t):void 0!==t[n]&&(e[n]=t[n])}}return e}(window);return Object.assign({},_t,t)}var Et=function(){this.generateTraceId=Tt(16),this.generateSpanId=Tt(8)},yt=Array(32);function Tt(t){return function(){for(var e=0;e<2*t;e++)yt[e]=Math.floor(16*Math.random())+48,yt[e]>=58&&(yt[e]+=39);return String.fromCharCode.apply(null,yt.slice(0,2*t))}}var St=performance,wt="opentelemetry",bt="webjs",Rt="0.12.0";var Nt=function(){function t(t){void 0===t&&(t=mt().OTEL_LOG_LEVEL),t>=et.DEBUG&&(this.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.debug.apply(console,t)}),t>=et.INFO&&(this.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.info.apply(console,t)}),t>=et.WARN&&(this.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.warn.apply(console,t)}),t>=et.ERROR&&(this.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.error.apply(console,t)})}return t.prototype.debug=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t.prototype.error=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t.prototype.warn=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t.prototype.info=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t}();var Ot,At=function(t){return t=null!=t?t:new Nt(et.ERROR),function(e){t.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){var e={},r=t;for(;null!==r;)Object.getOwnPropertyNames(r).forEach((function(t){if(!e[t]){var n=r[t];n&&(e[t]=String(n))}})),r=Object.getPrototypeOf(r);return e}(t))}(e))}}(),Pt=function(t){try{At(t)}catch(t){}},Ct=function(){function t(){}return t.prototype.debug=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t.prototype.error=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t.prototype.warn=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t.prototype.info=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r]},t}(),Lt=Math.pow(10,9);function Dt(t){var e=t/1e3,r=Math.trunc(e);return[r,Number((e-r).toFixed(9))*Lt]}function kt(){var t=St.timeOrigin;if("number"!=typeof t){var e=St;t=e.timing&&e.timing.fetchStart}return t}function Mt(t){var e=Dt(kt()),r=Dt("number"==typeof t?t:St.now()),n=e[0]+r[0],o=e[1]+r[1];return o>Lt&&(o-=Lt,n+=1),[n,o]}function xt(t){if(Ht(t))return t;if("number"==typeof t)return t<kt()?Mt(t):Dt(t);if(t instanceof Date)return[t.getTime(),0];throw TypeError("Invalid input type")}function It(t){return t[0]*Lt+t[1]}function Ut(t){return Math.round(1e6*t[0]+t[1]/1e3)}function Ht(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(Ot||(Ot={}));var jt=function(){function t(t){var e,r;void 0===t&&(t={}),this._propagators=null!==(e=t.propagators)&&void 0!==e?e:[],this._logger=null!==(r=t.logger)&&void 0!==r?r:new Ct,this._fields=Array.from(new Set(this._propagators.map((function(t){return"function"==typeof t.fields?t.fields():[]})).reduce((function(t,e){return t.concat(e)}))))}return t.prototype.inject=function(t,e,r){for(var n=0,o=this._propagators;n<o.length;n++){var i=o[n];try{i.inject(t,e,r)}catch(t){this._logger.warn("Failed to inject with "+i.constructor.name+". Err: "+t.message)}}},t.prototype.extract=function(t,e,r){var n=this;return this._propagators.reduce((function(t,o){try{return o.extract(t,e,r)}catch(t){n._logger.warn("Failed to inject with "+o.constructor.name+". Err: "+t.message)}return t}),t)},t.prototype.fields=function(){return this._fields.slice()},t}(),Ft=new RegExp("^(?:[a-z][_0-9a-z-*/]{0,255}|[a-z0-9][_0-9a-z-*/]{0,240}@[a-z][_0-9a-z-*/]{0,13})$"),Vt=/^[ -~]{0,255}[!-~]$/,Gt=/,|=/;var Bt=function(){function t(t){this._internalState=new Map,t&&this._parse(t)}return t.prototype.set=function(t,e){var r=this._clone();return r._internalState.has(t)&&r._internalState.delete(t),r._internalState.set(t,e),r},t.prototype.unset=function(t){var e=this._clone();return e._internalState.delete(t),e},t.prototype.get=function(t){return this._internalState.get(t)},t.prototype.serialize=function(){var t=this;return this._keys().reduce((function(e,r){return e.push(r+"="+t.get(r)),e}),[]).join(",")},t.prototype._parse=function(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((function(t,e){var r=e.trim(),n=r.indexOf("=");if(-1!==n){var o=r.slice(0,n),i=r.slice(n+1,e.length);(function(t){return Ft.test(t)})(o)&&function(t){return Vt.test(t)&&!Gt.test(t)}(i)&&t.set(o,i)}return t}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}(),zt="traceparent",qt="tracestate",Wt=/^(?!ff)[\da-f]{2}$/,Zt=/^(?![0]{32})[\da-f]{32}$/,Kt=/^(?![0]{16})[\da-f]{16}$/,Xt=/^[\da-f]{2}$/;var Yt=function(){function t(){}return t.prototype.inject=function(t,e,r){var n=s(t);if(n){var o="00-"+n.traceId+"-"+n.spanId+"-0"+Number(n.traceFlags||v.NONE).toString(16);r.set(e,zt,o),n.traceState&&r.set(e,qt,n.traceState.serialize())}},t.prototype.extract=function(t,e,r){var n=r.get(e,zt);if(!n)return t;var o=Array.isArray(n)?n[0]:n;if("string"!=typeof o)return t;var i=function(t){var e=t.trim().split("-");if("00"===e[0]&&4!==e.length)return null;var r=e[0],n=e[1],o=e[2],i=e[3];return Wt.test(r)&&Zt.test(n)&&Kt.test(o)&&Xt.test(i)?{traceId:n,spanId:o,traceFlags:parseInt(i,16)}:null}(o);if(!i)return t;i.isRemote=!0;var s=r.get(e,qt);if(s){var u=Array.isArray(s)?s.join(","):s;i.traceState=new Bt("string"==typeof u?u:void 0)}return function(t,e){return a(t,new j(e))}(t,i)},t.prototype.fields=function(){return[zt,qt]},t}(),$t=e("OpenTelemetry Distributed Contexts Key");var Jt="baggage",Qt=function(){function t(){}return t.prototype.inject=function(t,e,r){var n=function(t){return t.getValue($t)||void 0}(t);if(n){var o=this._getKeyPairs(n).filter((function(t){return t.length<=4096})).slice(0,180),i=this._serializeKeyPairs(o);i.length>0&&r.set(e,Jt,i)}},t.prototype._serializeKeyPairs=function(t){return t.reduce((function(t,e){var r=t+(""!=t?",":"")+e;return r.length>8192?t:r}),"")},t.prototype._getKeyPairs=function(t){return Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e].value)}))},t.prototype.extract=function(t,e,r){var n=this,o=r.get(e,Jt);if(!o)return t;var i={};return 0==o.length?t:(o.split(",").forEach((function(t){var e=n._parsePairKeyValue(t);e&&(i[e.key]={value:e.value})})),0===Object.entries(i).length?t:function(t,e){return t.setValue($t,e)}(t,i))},t.prototype._parsePairKeyValue=function(t){var e=t.split(";");if(!(e.length<=0)){var r=e.shift();if(r){var n=r.split("=");if(2==n.length){var o=decodeURIComponent(n[0].trim()),i=decodeURIComponent(n[1].trim());return e.length>0&&(i=i+";"+e.join(";")),{key:o,value:i}}}}},t.prototype.fields=function(){return[Jt]},t}(),te=function(t){function e(e){var r=t.call(this,e)||this;return r._context=e||U,r}return _(e,t),e.prototype.context=function(){return this._context},e}(j),ee=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:V.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}(),re=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:V.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}(),ne=function(){function t(t){var e,r,n,o;this._root=t.root,this._root||(Pt(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new re),this._remoteParentSampled=null!==(e=t.remoteParentSampled)&&void 0!==e?e:new re,this._remoteParentNotSampled=null!==(r=t.remoteParentNotSampled)&&void 0!==r?r:new ee,this._localParentSampled=null!==(n=t.localParentSampled)&&void 0!==n?n:new re,this._localParentNotSampled=null!==(o=t.localParentNotSampled)&&void 0!==o?o:new ee}return t.prototype.shouldSample=function(t,e,r,n,o,i){var a=s(t);return a?a.isRemote?a.traceFlags&v.SAMPLED?this._remoteParentSampled.shouldSample(t,e,r,n,o,i):this._remoteParentNotSampled.shouldSample(t,e,r,n,o,i):a.traceFlags&v.SAMPLED?this._localParentSampled.shouldSample(t,e,r,n,o,i):this._localParentNotSampled.shouldSample(t,e,r,n,o,i):this._root.shouldSample(t,e,r,n,o,i)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}(),oe=function(){function t(t){void 0===t&&(t=0),this._ratio=t,this._ratio=this._normalize(t)}return t.prototype.shouldSample=function(t,e){for(var r=0,n=0;n<e.length;n++)r+=e.charCodeAt(n);return{decision:r%100/100<this._ratio?V.RECORD_AND_SAMPLED:V.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t},t}();function ie(t,e){return"string"==typeof e?t===e:!!t.match(e)}function ae(t,e){if(!e)return!1;for(var r=0,n=e;r<n.length;r++){if(ie(t,n[r]))return!0}return!1}function se(t){return"function"==typeof t&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped}var ue="exception.message",ce="exception.stacktrace",pe="exception.type",he="http.host",fe="http.method",de="http.url",le="http.status_code",_e="http.status_text",ve="http.scheme",ge="http.response_content_length",me="http.user_agent",Ee=function(){function t(t,e,r,n,o,i,a,s){void 0===a&&(a=[]),void 0===s&&(s=Mt()),this.attributes={},this.links=[],this.events=[],this.status={code:B.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=r,this.spanContext=n,this.parentSpanId=i,this.kind=o,this.links=a,this.startTime=xt(s),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this._logger=t.logger,this._traceParams=t.getActiveTraceParams(),this._spanProcessor=t.getActiveSpanProcessor(),this._spanProcessor.onStart(this,e)}return t.prototype.context=function(){return this.spanContext},t.prototype.setAttribute=function(t,e){if(null==e||this._isSpanEnded())return this;if(0===t.length)return this._logger.warn("Invalid attribute key: "+t),this;if(!ht(e))return this._logger.warn("Invalid attribute value set for key: "+t),this;if(Object.keys(this.attributes).length>=this._traceParams.numberOfAttributesPerSpan){var r=Object.keys(this.attributes).shift();r&&(this._logger.warn("Dropping extra attributes : "+r),delete this.attributes[r])}return this.attributes[t]=e,this},t.prototype.setAttributes=function(t){for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],o=n[0],i=n[1];this.setAttribute(o,i)}return this},t.prototype.addEvent=function(t,e,r){return this._isSpanEnded()||(this.events.length>=this._traceParams.numberOfEventsPerSpan&&(this._logger.warn("Dropping extra events."),this.events.shift()),(Ht(n=e)||"number"==typeof n||n instanceof Date)&&(void 0===r&&(r=e),e=void 0),void 0===r&&(r=Mt()),this.events.push({name:t,attributes:e,time:xt(r)})),this;var n},t.prototype.setStatus=function(t){return this._isSpanEnded()||(this.status=t),this},t.prototype.updateName=function(t){return this._isSpanEnded()||(this.name=t),this},t.prototype.end=function(t){void 0===t&&(t=Mt()),this._isSpanEnded()?this._logger.error("You can only call end() on a span once."):(this._ended=!0,this.endTime=xt(t),this._duration=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=Lt),[r,n]}(this.startTime,this.endTime),this._duration[0]<0&&this._logger.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this))},t.prototype.isRecording=function(){return!1===this._ended},t.prototype.recordException=function(t,e){void 0===e&&(e=Mt());var r={};"string"==typeof t?r[ue]=t:t&&(t.code?r[pe]=t.code:t.name&&(r[pe]=t.name),t.message&&(r[ue]=t.message),t.stack&&(r[ce]=t.stack)),r[pe]||r[ue]?this.addEvent("exception",r,e):this._logger.warn("Failed to record an exception "+t)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),t.prototype._isSpanEnded=function(){return this._ended&&this._logger.warn("Can not execute the operation on ended Span {traceId: %s, spanId: %s}",this.spanContext.traceId,this.spanContext.spanId),this._ended},t}(),ye={logLevel:mt().OTEL_LOG_LEVEL,sampler:new re,traceParams:{numberOfAttributesPerSpan:32,numberOfLinksPerSpan:32,numberOfEventsPerSpan:128},gracefulShutdown:!0};var Te=function(){function t(t,e,r){this._tracerProvider=r;var n,o,i,a,s=(o=(n=e).traceParams,i=mt().OTEL_SAMPLING_PROBABILITY,a=Object.assign(ye,void 0!==i&&i<1?{sampler:new ne({root:new oe(i)})}:{},n),o&&(a.traceParams.numberOfAttributesPerSpan=o.numberOfAttributesPerSpan||32,a.traceParams.numberOfEventsPerSpan=o.numberOfEventsPerSpan||128,a.traceParams.numberOfLinksPerSpan=o.numberOfLinksPerSpan||32),a);this._sampler=s.sampler,this._traceParams=s.traceParams,this._idGenerator=e.idGenerator||new Et,this.resource=r.resource,this.instrumentationLibrary=t,this.logger=e.logger||new Nt(e.logLevel)}return t.prototype.startSpan=function(t,e,r){var n,i;if(void 0===e&&(e={}),void 0===r&&(r=ut.active()),function(t){return Boolean(t.getValue(o))}(r))return this.logger.debug("Instrumentation suppressed, returning Noop Span"),F;var a,u,c=function(t,e){return t.root?void 0:s(e)}(e,r),p=this._idGenerator.generateSpanId();c&&ct.isSpanContextValid(c)?(a=c.traceId,u=c.traceState):a=this._idGenerator.generateTraceId();var h=null!==(n=e.kind)&&void 0!==n?n:G.INTERNAL,f=null!==(i=e.links)&&void 0!==i?i:[],d=function(t){var e={};if(null==t||"object"!=typeof t)return e;for(var r=0,n=Object.entries(t);r<n.length;r++){var o=n[r],i=o[0],a=o[1];ht(a)&&(Array.isArray(a)?e[i]=a.slice():e[i]=a)}return e}(e.attributes),l=this._sampler.shouldSample(r,a,t,h,d,f),_={traceId:a,spanId:p,traceFlags:l.decision===V.RECORD_AND_SAMPLED?v.SAMPLED:v.NONE,traceState:u};if(l.decision===V.NOT_RECORD)return this.logger.debug("Recording is off, starting no recording span"),new te(_);var g=new Ee(this,r,t,_,h,c?c.spanId:void 0,f,e.startTime);return g.setAttributes(Object.assign(d,l.attributes)),g},t.prototype.getCurrentSpan=function(){return i(ut.active())},t.prototype.withSpan=function(t,e){return ut.with(a(ut.active(),t),e)},t.prototype.bind=function(t,e){return ut.bind(t,e?a(ut.active(),e):ut.active())},t.prototype.getActiveTraceParams=function(){return this._traceParams},t.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},t}();var Se,we=function(){function t(t){this._spanProcessors=t}return t.prototype.forceFlush=function(){for(var t=[],e=0,r=this._spanProcessors;e<r.length;e++){var n=r[e];t.push(n.forceFlush())}return new Promise((function(e){Promise.all(t).then((function(){e()})).catch((function(t){Pt(t||new Error("MultiSpanProcessor: forceFlush failed")),e()}))}))},t.prototype.onStart=function(t,e){for(var r=0,n=this._spanProcessors;r<n.length;r++){n[r].onStart(t,e)}},t.prototype.onEnd=function(t){for(var e=0,r=this._spanProcessors;e<r.length;e++){r[e].onEnd(t)}},t.prototype.shutdown=function(){for(var t=[],e=0,r=this._spanProcessors;e<r.length;e++){var n=r[e];t.push(n.shutdown())}return new Promise((function(e,r){Promise.all(t).then((function(){e()}),r)}))},t}(),be=function(){function t(){}return t.prototype.onStart=function(t,e){},t.prototype.onEnd=function(t){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve()},t}(),Re="telemetry.sdk.name",Ne="telemetry.sdk.language",Oe="telemetry.sdk.version",Ae=function(){function t(t){this.attributes=t}return t.empty=function(){return t.EMPTY},t.createTelemetrySDKResource=function(){var e;return new t(((e={})[Ne]=bt,e[Re]=wt,e[Oe]=Rt,e))},t.prototype.merge=function(e){return e&&Object.keys(e.attributes).length?new t(Object.assign({},e.attributes,this.attributes)):this},t.EMPTY=new t({}),t}(),Pe=function(){function t(t){var e,r;void 0===t&&(t=ye),this._registeredSpanProcessors=[],this._tracers=new Map,this.activeSpanProcessor=new be,this.logger=null!==(e=t.logger)&&void 0!==e?e:new Nt(t.logLevel),this.resource=null!==(r=t.resource)&&void 0!==r?r:Ae.createTelemetrySDKResource(),this._config=Object.assign({},t,{logger:this.logger,resource:this.resource})}return t.prototype.getTracer=function(t,e,r){void 0===e&&(e="*");var n=t+"@"+e;return this._tracers.has(n)||this._tracers.set(n,new Te({name:t,version:e},r||this._config,this)),this._tracers.get(n)},t.prototype.addSpanProcessor=function(t){this._registeredSpanProcessors.push(t),this.activeSpanProcessor=new we(this._registeredSpanProcessors)},t.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},t.prototype.register=function(t){void 0===t&&(t={}),ct.setGlobalTracerProvider(this),void 0===t.propagator&&(t.propagator=new jt({propagators:[new Qt,new Yt]})),t.contextManager&&ut.setGlobalContextManager(t.contextManager),t.propagator&&pt.setGlobalPropagator(t.propagator)},t.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},t}(),Ce=function(){function t(){}return t.prototype.export=function(t,e){return this._sendSpans(t,e)},t.prototype.shutdown=function(){return this._sendSpans([]),Promise.resolve()},t.prototype._exportInfo=function(t){return{traceId:t.spanContext.traceId,parentId:t.parentSpanId,name:t.name,id:t.spanContext.spanId,kind:t.kind,timestamp:Ut(t.startTime),duration:Ut(t.duration),attributes:t.attributes,status:t.status,events:t.events}},t.prototype._sendSpans=function(t,e){for(var r=0,n=t;r<n.length;r++){var o=n[r];console.log(this._exportInfo(o))}if(e)return e({code:Ot.SUCCESS})},t}(),Le=function(){function t(t,e){this._exporter=t,this._finishedSpans=[],this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve(),this._bufferSize=e&&e.bufferSize?e.bufferSize:100,this._bufferTimeout=e&&"number"==typeof e.bufferTimeout?e.bufferTimeout:2e4}return t.prototype.forceFlush=function(){return this._isShutdown?this._shuttingDownPromise:this._flush()},t.prototype.onStart=function(t){},t.prototype.onEnd=function(t){this._isShutdown||this._addToBuffer(t)},t.prototype.shutdown=function(){var t=this;return this._isShutdown||(this._isShutdown=!0,this._shuttingDownPromise=new Promise((function(e,r){Promise.resolve().then((function(){return t._flush()})).then((function(){return t._exporter.shutdown()})).then(e).catch((function(t){r(t)}))}))),this._shuttingDownPromise},t.prototype._addToBuffer=function(t){this._finishedSpans.push(t),this._maybeStartTimer(),this._finishedSpans.length>this._bufferSize&&this._flush().catch((function(t){Pt(t)}))},t.prototype._flush=function(){var t=this;return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((function(e,r){ut.with(u(ut.active()),(function(){t._exporter.export(t._finishedSpans,(function(n){var o;t._finishedSpans=[],n.code===Ot.SUCCESS?e():r(null!==(o=n.error)&&void 0!==o?o:new Error("BatchSpanProcessor: span export failed"))}))}))}))},t.prototype._maybeStartTimer=function(){var t=this;void 0===this._timer&&(this._timer=setTimeout((function(){t._flush().catch((function(t){Pt(t)}))}),this._bufferTimeout),this._timer)},t.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},t}(),De=function(){function t(t){this._exporter=t,this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve()}return t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.onStart=function(t){},t.prototype.onEnd=function(t){var e=this;this._isShutdown||ut.with(u(ut.active()),(function(){e._exporter.export([t],(function(t){var e;t.code!==Ot.SUCCESS&&Pt(null!==(e=t.error)&&void 0!==e?e:new Error("SimpleSpanProcessor: span export failed (status "+t+")"))}))}))},t.prototype.shutdown=function(){var t=this;return this._isShutdown||(this._isShutdown=!0,this._shuttingDownPromise=new Promise((function(e,r){Promise.resolve().then((function(){return t._exporter.shutdown()})).then(e).catch((function(t){r(t)}))}))),this._shuttingDownPromise},t}(),ke=function(){function e(){this._enabled=!1,this._currentContext=t}return e.prototype._bindFunction=function(e,r){void 0===r&&(r=t);var n=this,o=function(){for(var t=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n.with(r,(function(){return e.apply(t,o)}))};return Object.defineProperty(o,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),o},e.prototype.active=function(){return this._currentContext},e.prototype.bind=function(e,r){return void 0===r&&(r=t),void 0===r&&(r=this.active()),"function"==typeof e?this._bindFunction(e,r):e},e.prototype.disable=function(){return this._currentContext=t,this._enabled=!1,this},e.prototype.enable=function(){return this._enabled||(this._enabled=!0,this._currentContext=t),this},e.prototype.with=function(e,r){var n=this._currentContext;this._currentContext=e||t;try{return r()}finally{this._currentContext=n}},e}(),Me=function(t){function e(e){void 0===e&&(e={});var r;void 0===e.plugins&&(e.plugins=[]),r=t.call(this,e)||this;for(var n=0,o=e.plugins;n<o.length;n++){o[n].enable([],r,r.logger)}if(e.contextManager)throw"contextManager should be defined in register method not in constructor";if(e.propagator)throw"propagator should be defined in register method not in constructor";return r}return _(e,t),e.prototype.register=function(e){void 0===e&&(e={}),void 0===e.contextManager&&(e.contextManager=new ke),e.contextManager&&e.contextManager.enable(),t.prototype.register.call(this,e)},e}(Pe);!function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(Se||(Se={}));var xe,Ie=document.createElement("a");function Ue(t,e){return e in t}function He(t,e,r){if(Ue(r,e)&&"number"==typeof r[e]){if(0===r[e])return;return t.addEvent(e,r[e]),t}}function je(t,e){He(t,Se.FETCH_START,e),He(t,Se.DOMAIN_LOOKUP_START,e),He(t,Se.DOMAIN_LOOKUP_END,e),He(t,Se.CONNECT_START,e),He(t,Se.SECURE_CONNECTION_START,e),He(t,Se.CONNECT_END,e),He(t,Se.REQUEST_START,e),He(t,Se.RESPONSE_START,e),He(t,Se.RESPONSE_END,e),e[Se.ENCODED_BODY_SIZE]&&t.setAttribute(ge,e[Se.ENCODED_BODY_SIZE])}function Fe(t,e,r,n,o,i){void 0===o&&(o=new WeakSet),Ie.href=t;var a=function(t,e,r,n,o,i){var a=It(e),s=It(r),u=n.filter((function(e){var r=It(xt(e[Se.FETCH_START])),n=It(xt(e[Se.RESPONSE_END]));return e.initiatorType.toLowerCase()===(i||"xmlhttprequest")&&e.name===t&&r>=a&&n<=s}));u.length>0&&(u=u.filter((function(t){return!o.has(t)})));return u}(t=Ie.href,e,r,n,o,i);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};var s=function(t){return t.slice().sort((function(t,e){var r=t[Se.FETCH_START],n=e[Se.FETCH_START];return r>n?1:r<n?-1:0}))}(a.slice());if(Ve(t).origin!==window.location.origin&&s.length>1){var u=s[0],c=function(t,e,r){for(var n,o=It(r),i=It(xt(e)),a=t[1],s=t.length,u=1;u<s;u++){var c=t[u],p=It(xt(c[Se.FETCH_START])),h=o-It(xt(c[Se.RESPONSE_END]));p>=i&&(!n||h<n)&&(n=h,a=c)}return a}(s,u[Se.RESPONSE_END],r),p=u[Se.RESPONSE_END];return c[Se.FETCH_START]<p&&(c=u,u=void 0),{corsPreFlightRequest:u,mainRequest:c}}return{mainRequest:a[0]}}function Ve(t){var e=document.createElement("a");return e.href=t,e}function Ge(t,e){if(t.nodeType===Node.DOCUMENT_NODE)return"/";var r=function(t,e){var r=t.nodeType,n=function(t){if(!t.parentNode)return 0;var e=[t.nodeType];t.nodeType===Node.CDATA_SECTION_NODE&&e.push(Node.TEXT_NODE);var r=Array.from(t.parentNode.childNodes);if((r=r.filter((function(r){var n=r.localName;return e.indexOf(r.nodeType)>=0&&n===t.localName}))).length>=1)return r.indexOf(t)+1;return 0}(t),o="";if(r===Node.ELEMENT_NODE){var i=t.getAttribute("id");if(e&&i)return'//*[@id="'+i+'"]';o=t.localName}else if(r===Node.TEXT_NODE||r===Node.CDATA_SECTION_NODE)o="text()";else{if(r!==Node.COMMENT_NODE)return"";o="comment()"}if(o&&n>1)return"/"+o+"["+n+"]";return"/"+o}(t,e);if(e&&r.indexOf("@id")>0)return r;var n="";return t.parentNode&&(n+=Ge(t.parentNode,!1)),n+=r}function Be(t,e){var r=e||[];return("string"==typeof r||r instanceof RegExp)&&(r=[r]),Ve(t).origin===window.location.origin||r.some((function(e){return ie(t,e)}))}!function(t){t.COMPONENT="component",t.DOCUMENT_LOAD="documentLoad",t.DOCUMENT_FETCH="documentFetch",t.RESOURCE_FETCH="resourceFetch"}(xe||(xe={}));var ze=function(t){function e(e){void 0===e&&(e={});var r=t.call(this,"@opentelemetry/plugin-document-load","0.11.0")||this;return r.component="document-load",r.version="1",r.moduleName=r.component,r._onDocumentLoaded=r._onDocumentLoaded.bind(r),r._config=e,r}return _(e,t),e.prototype._onDocumentLoaded=function(){var t=this;window.setTimeout((function(){t._collectPerformance()}))},e.prototype._addResourcesSpans=function(t){var e=this,r=St.getEntriesByType("resource");r&&r.forEach((function(r){e._initResourceSpan(r,{parent:t})}))},e.prototype._collectPerformance=function(){var t=this,e=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}(document.getElementsByTagName("meta")).find((function(t){return t.getAttribute("name")===zt})),r=this._getEntries(),n=e&&e.content||"";ut.with(pt.extract({traceparent:n}),(function(){var e=t._startSpan(xe.DOCUMENT_LOAD,Se.FETCH_START,r);e&&(t._tracer.withSpan(e,(function(){var e=t._startSpan(xe.DOCUMENT_FETCH,Se.FETCH_START,r);e&&t._tracer.withSpan(e,(function(){je(e,r),t._endSpan(e,Se.RESPONSE_END,r)}))})),t._addResourcesSpans(e),He(e,Se.FETCH_START,r),He(e,Se.UNLOAD_EVENT_START,r),He(e,Se.UNLOAD_EVENT_END,r),He(e,Se.DOM_INTERACTIVE,r),He(e,Se.DOM_CONTENT_LOADED_EVENT_START,r),He(e,Se.DOM_CONTENT_LOADED_EVENT_END,r),He(e,Se.DOM_COMPLETE,r),He(e,Se.LOAD_EVENT_START,r),He(e,Se.LOAD_EVENT_END,r),t._endSpan(e,Se.LOAD_EVENT_END,r))}))},e.prototype._endSpan=function(t,e,r){t&&(Ue(r,e)?t.end(r[e]):t.end())},e.prototype._getEntries=function(){var t={},e=St.getEntriesByType("navigation")[0];if(e){Object.values(Se).forEach((function(r){if(Ue(e,r)){var n=e[r];"number"==typeof n&&n>=0&&(t[r]=n)}}))}else{var r=St.timing;if(r)Object.values(Se).forEach((function(e){if(Ue(r,e)){var n=r[e];"number"==typeof n&&n>=0&&(t[e]=n)}}))}return t},e.prototype._initResourceSpan=function(t,e){void 0===e&&(e={});var r=this._startSpan(xe.RESOURCE_FETCH,Se.FETCH_START,t,e);r&&(r.setAttribute(de,t.name),je(r,t),this._endSpan(r,Se.RESPONSE_END,t))},e.prototype._startSpan=function(t,e,r,n){if(void 0===n&&(n={}),Ue(r,e)&&"number"==typeof r[e]){var o=this._tracer.startSpan(t,Object.assign({},{startTime:r[e]},n));return o.setAttribute(xe.COMPONENT,this.component),o}},e.prototype._waitForPageLoad=function(){"complete"===window.document.readyState?this._onDocumentLoaded():window.addEventListener("load",this._onDocumentLoaded)},e.prototype.patch=function(){return this._waitForPageLoad(),this._moduleExports},e.prototype.unpatch=function(){window.removeEventListener("load",this._onDocumentLoaded)},e}(dt);function qe(t,e){if(t&&t[1]&&t[2]){const r=t[1],n=t[2];e.setAttribute("link.traceId",r),e.setAttribute("link.spanId",n)}}const We=new RegExp('traceparent;desc="00-([0-9a-f]{32})-([0-9a-f]{16})-01"');function Ze(t,e){for(let r of t.split(",")){r=r.trim();qe(r.match(We),e)}}const Ke=new RegExp("00-([0-9a-f]{32})-([0-9a-f]{16})-01");class Xe extends ze{_endSpan(t,e,r){return t&&"documentLoad"!==t.name&&function(t,e){if(t.serverTiming)for(const r of t.serverTiming)"traceparent"===r.name&&r.description&&qe(r.description.match(Ke),e)}(r,t),t&&"documentLoad"===t.name&&function(t){document.referrer&&""!==document.referrer&&t.setAttribute("document.referrer",document.referrer),window.screen&&t.setAttribute("screen.xy",window.screen.width+"x"+window.screen.height)}(t),super._endSpan(t,e,r)}_getEntries(){const t=super._getEntries();if(t){const e=performance.getEntriesByType&&performance.getEntriesByType("navigation");e&&e[0]&&e[0].serverTiming&&(t.serverTiming=e[0].serverTiming)}return t}}function Ye(t){return"function"==typeof t}var $e=console.error.bind(console);function Je(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function Qe(t){t&&t.logger&&(Ye(t.logger)?$e=t.logger:$e("new logger isn't a function, not replacing"))}function tr(t,e,r){if(t&&t[e]){if(!r)return $e("no wrapper function"),void $e((new Error).stack);if(Ye(t[e])&&Ye(r)){var n=t[e],o=r(n,e);return Je(o,"__original",n),Je(o,"__unwrap",(function(){t[e]===o&&Je(t,e,n)})),Je(o,"__wrapped",!0),Je(t,e,o),o}$e("original object and wrapper must be functions")}else $e("no original function "+e+" to wrap")}function er(t,e){return t&&t[e]?t[e].__unwrap?t[e].__unwrap():void $e("no original to unwrap to -- has "+e+" already been unwrapped?"):($e("no function to unwrap."),void $e((new Error).stack))}Qe.wrap=tr,Qe.massWrap=function(t,e,r){if(!t)return $e("must provide one or more modules to patch"),void $e((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){tr(t,e,r)}))})):$e("must provide one or more functions to wrap on modules")},Qe.unwrap=er,Qe.massUnwrap=function(t,e){if(!t)return $e("must provide one or more modules to patch"),void $e((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){er(t,e)}))})):$e("must provide one or more functions to unwrap on modules")};var rr,nr=Qe;!function(t){t.METHOD_OPEN="open",t.METHOD_SEND="send",t.EVENT_ABORT="abort",t.EVENT_ERROR="error",t.EVENT_LOAD="loaded",t.EVENT_TIMEOUT="timeout"}(rr||(rr={}));var or,ir="0.12.0",ar=function(t){function e(e){void 0===e&&(e={});var r=t.call(this,"@opentelemetry/plugin-xml-http-request",ir)||this;return r._config=e,r.component="xml-http-request",r.version=ir,r.moduleName=r.component,r._tasksCount=0,r._xhrMem=new WeakMap,r._usedResources=new WeakSet,r}return _(e,t),e.prototype._addHeaders=function(t,e){if(Be(e,this._config.propagateTraceHeaderCorsUrls)){var r={};pt.inject(r),Object.keys(r).forEach((function(e){t.setRequestHeader(e,String(r[e]))}))}},e.prototype._addChildSpan=function(t,e){var r=this;this._tracer.withSpan(t,(function(){var t=r._tracer.startSpan("CORS Preflight",{startTime:e[Se.FETCH_START]});je(t,e),t.end(e[Se.RESPONSE_END])}))},e.prototype._addFinalSpanAttributes=function(t,e,r){if("string"==typeof r){var n=Ve(r);t.setAttribute(le,e.status),t.setAttribute(_e,e.statusText),t.setAttribute(he,n.host),t.setAttribute(ve,n.protocol.replace(":","")),t.setAttribute(me,navigator.userAgent)}},e.prototype._addResourceObserver=function(t,e){var r=this._xhrMem.get(t);r&&void 0!==window.PerformanceObserver&&(r.createdResources={observer:new PerformanceObserver((function(t){t.getEntries().forEach((function(t){"xmlhttprequest"===t.initiatorType&&t.name===e&&r.createdResources&&r.createdResources.entries.push(t)}))})),entries:[]},r.createdResources.observer.observe({entryTypes:["resource"]}))},e.prototype._clearResources=function(){0===this._tasksCount&&this._config.clearTimingResources&&(St.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)},e.prototype._findResourceAndAddNetworkEvents=function(t,e,r,n,o){if(r&&n&&o&&t.createdResources){var i=t.createdResources.entries;i&&i.length||(i=St.getEntriesByType("resource"));var a=Fe(r,n,o,i,this._usedResources);if(a.mainRequest){var s=a.mainRequest;this._markResourceAsUsed(s);var u=a.corsPreFlightRequest;u&&(this._addChildSpan(e,u),this._markResourceAsUsed(u)),je(e,s)}}},e.prototype._cleanPreviousSpanInformation=function(t){var e=this._xhrMem.get(t);if(e){var r=e.callbackToRemoveEvents;r&&r(),this._xhrMem.delete(t)}},e.prototype._createSpan=function(t,e,r){var n;if(!ae(e,this._config.ignoreUrls)){var o="HTTP "+r.toUpperCase(),i=this._tracer.startSpan(o,{kind:G.CLIENT,attributes:(n={},n[fe]=r,n[de]=e,n)});return i.addEvent(rr.METHOD_OPEN),this._cleanPreviousSpanInformation(t),this._xhrMem.set(t,{span:i,spanUrl:e}),i}this._logger.debug("ignoring span as url matches ignored url")},e.prototype._markResourceAsUsed=function(t){this._usedResources.add(t)},e.prototype._patchOpen=function(){var t=this;return function(e){var r=t;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=t[0],i=t[1];return r._createSpan(this,i,o),e.apply(this,t)}}},e.prototype._patchSend=function(){var t=this;function e(e,r){var n=t._xhrMem.get(r);if(n){n.status=r.status,n.statusText=r.statusText,t._xhrMem.delete(r);var o=Mt();setTimeout((function(){!function(e,r,n){var o=r.callbackToRemoveEvents;"function"==typeof o&&o();var i=r.span,a=r.spanUrl,s=r.sendStartTime;i&&(t._findResourceAndAddNetworkEvents(r,i,a,s,n),i.addEvent(e,n),t._addFinalSpanAttributes(i,r,a),i.end(n),t._tasksCount--),t._clearResources()}(e,n,o)}),300)}}function r(){e(rr.EVENT_ERROR,this)}function n(){e(rr.EVENT_ABORT,this)}function o(){e(rr.EVENT_TIMEOUT,this)}function i(){this.status<299?e(rr.EVENT_LOAD,this):e(rr.EVENT_ERROR,this)}function a(e){e.removeEventListener("abort",n),e.removeEventListener("error",r),e.removeEventListener("load",i),e.removeEventListener("timeout",o);var a=t._xhrMem.get(e);a&&(a.callbackToRemoveEvents=void 0)}return function(e){return function(){for(var s=this,u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];var p=t._xhrMem.get(this);if(!p)return e.apply(this,u);var h=p.span,f=p.spanUrl;return h&&f&&t._tracer.withSpan(h,(function(){t._tasksCount++,p.sendStartTime=Mt(),h.addEvent(rr.METHOD_SEND),s.addEventListener("abort",n),s.addEventListener("error",r),s.addEventListener("load",i),s.addEventListener("timeout",o),p.callbackToRemoveEvents=function(){a(s),p.createdResources&&p.createdResources.observer.disconnect()},t._addHeaders(s,f),t._addResourceObserver(s,f)})),e.apply(this,u)}}},e.prototype.patch=function(){return this._logger.debug("applying patch to",this.moduleName,this.version),se(XMLHttpRequest.prototype.open)&&(nr.unwrap(XMLHttpRequest.prototype,"open"),this._logger.debug("removing previous patch from method open")),se(XMLHttpRequest.prototype.send)&&(nr.unwrap(XMLHttpRequest.prototype,"send"),this._logger.debug("removing previous patch from method send")),nr.wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),nr.wrap(XMLHttpRequest.prototype,"send",this._patchSend()),this._moduleExports},e.prototype.unpatch=function(){this._logger.debug("removing patch from",this.moduleName,this.version),nr.unwrap(XMLHttpRequest.prototype,"open"),nr.unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet},e}(dt);!function(t){t.COMPONENT="component",t.HTTP_HOST="http.host",t.HTTP_FLAVOR="http.flavor",t.HTTP_METHOD="http.method",t.HTTP_SCHEME="http.scheme",t.HTTP_STATUS_CODE="http.status_code",t.HTTP_STATUS_TEXT="http.status_text",t.HTTP_URL="http.url",t.HTTP_TARGET="http.target",t.HTTP_USER_AGENT="http.user_agent",t.HTTP_RESPONSE_CONTENT_LENGTH="http.response_content_length"}(or||(or={}));var sr,ur=function(t){function e(e){void 0===e&&(e={});var r=t.call(this,"@opentelemetry/plugin-fetch","0.12.0")||this;return r._config=e,r.moduleName="fetch",r._usedResources=new WeakSet,r._tasksCount=0,r}return _(e,t),e.prototype._addChildSpan=function(t,e){var r=this._tracer.startSpan("CORS Preflight",{startTime:e[Se.FETCH_START]},a(ut.active(),t));je(r,e),r.end(e[Se.RESPONSE_END])},e.prototype._addFinalSpanAttributes=function(t,e){var r=Ve(e.url);t.setAttribute(or.HTTP_STATUS_CODE,e.status),t.setAttribute(or.HTTP_STATUS_TEXT,e.statusText),t.setAttribute(or.HTTP_HOST,r.host),t.setAttribute(or.HTTP_SCHEME,r.protocol.replace(":","")),t.setAttribute(or.HTTP_USER_AGENT,navigator.userAgent)},e.prototype._addHeaders=function(t,e){if(Be(e,this._config.propagateTraceHeaderCorsUrls))if(t instanceof Request)pt.inject(t.headers,{set:function(t,e,r){return t.set(e,"string"==typeof r?r:String(r))}});else{var r={};pt.inject(r),t.headers=Object.assign({},r,t.headers||{})}},e.prototype._clearResources=function(){0===this._tasksCount&&this._config.clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)},e.prototype._createSpan=function(t,e){var r;if(void 0===e&&(e={}),!ae(t,this._config.ignoreUrls)){var n=(e.method||"GET").toUpperCase(),o="HTTP "+n;return this._tracer.startSpan(o,{kind:G.CLIENT,attributes:(r={},r[or.COMPONENT]=this.moduleName,r[or.HTTP_METHOD]=n,r[or.HTTP_URL]=t,r)})}this._logger.debug("ignoring span as url matches ignored url")},e.prototype._findResourceAndAddNetworkEvents=function(t,e,r){var n=e.entries;n.length||(n=performance.getEntriesByType("resource"));var o=Fe(e.spanUrl,e.startTime,r,n,this._usedResources,"fetch");if(o.mainRequest){var i=o.mainRequest;this._markResourceAsUsed(i);var a=o.corsPreFlightRequest;a&&(this._addChildSpan(t,a),this._markResourceAsUsed(a)),je(t,i)}},e.prototype._markResourceAsUsed=function(t){this._usedResources.add(t)},e.prototype._endSpan=function(t,e,r){var n=this,o=Mt();e.observer.disconnect(),this._addFinalSpanAttributes(t,r),setTimeout((function(){n._findResourceAndAddNetworkEvents(t,e,o),n._tasksCount--,n._clearResources(),t.end(o)}),300)},e.prototype._patchConstructor=function(){var t=this;return function(e){var r=t;return function(t,n){var o=this,i=t instanceof Request?t.url:t,a=t instanceof Request?t:n||{},s=r._createSpan(i,a);if(!s)return e.apply(this,[i,a]);var u=r._prepareSpanData(i);function c(t,e,n){try{n.status>=200&&n.status<400?r._endSpan(t,u,n):r._endSpan(t,u,{status:n.status,statusText:n.statusText,url:i})}finally{e(n)}}function p(t,e,n){try{r._endSpan(t,u,{status:n.status||0,statusText:n.message,url:i})}finally{e(n)}}return new Promise((function(t,n){return r._tracer.withSpan(s,(function(){return r._addHeaders(a,i),r._tasksCount++,e.apply(o,[i,a]).then(c.bind(o,s,t),p.bind(o,s,n))}))}))}}},e.prototype._prepareSpanData=function(t){var e=Mt(),r=new PerformanceObserver((function(e){var r=e.getEntries();r.forEach((function(e){"fetch"===e.initiatorType&&e.name===t&&r.push(e)}))}));return r.observe({entryTypes:["resource"]}),{entries:[],observer:r,startTime:e,spanUrl:t}},e.prototype.patch=function(){return se(window.fetch)&&(nr.unwrap(window,"fetch"),this._logger.debug("removing previous patch for constructor")),nr.wrap(window,"fetch",this._patchConstructor()),this._moduleExports},e.prototype.unpatch=function(){nr.unwrap(window,"fetch"),this._usedResources=new WeakSet},e}(dt);class cr extends ar{_createSpan(t,e,r){const n=super._createSpan(t,e,r);return n&&(t.addEventListener("readystatechange",(function(){if(t.readyState===t.HEADERS_RECEIVED&&t.getAllResponseHeaders().includes("server-timing")){const e=t.getResponseHeader("server-timing");e&&Ze(e,n)}})),n.setAttribute("component",this.moduleName)),n}}class pr extends ur{_addFinalSpanAttributes(t,e){if(t&&e&&e.headers){const r=e.headers.get("Server-Timing");r&&Ze(r,t)}return super._addFinalSpanAttributes(t,e)}}!function(t){t.COMPONENT="component",t.EVENT_TYPE="event_type",t.TARGET_ELEMENT="target_element",t.TARGET_XPATH="target_xpath",t.HTTP_URL="http.url",t.HTTP_USER_AGENT="http.user_agent"}(sr||(sr={}));var hr="0.11.0",fr=function(t){function e(){var e=t.call(this,"@opentelemetry/plugin-user-interaction",hr)||this;return e.component="user-interaction",e.version=hr,e.moduleName=e.component,e._spansData=new WeakMap,e._zonePatched=!1,e._wrappedListeners=new WeakMap,e._eventsSpanMap=new WeakMap,e}return _(e,t),e.prototype._checkForTimeout=function(t,e){var r=this._spansData.get(e);r&&("setTimeout"===t.source?r.hrTimeLastTimeout=Mt():"Promise.then"!==t.source&&"setTimeout"!==t.source&&(r.hrTimeLastTimeout=void 0))},e.prototype._allowEventType=function(t){return"click"===t},e.prototype._createSpan=function(t,e,r){var n;if(t.getAttribute&&!t.hasAttribute("disabled")&&this._allowEventType(e)){var o=Ge(t,!0);try{var i=this._tracer.startSpan(e,{parent:r,attributes:(n={},n[sr.COMPONENT]=this.component,n[sr.EVENT_TYPE]=e,n[sr.TARGET_ELEMENT]=t.tagName,n[sr.TARGET_XPATH]=o,n[sr.HTTP_URL]=window.location.href,n[sr.HTTP_USER_AGENT]=navigator.userAgent,n)});return this._spansData.set(i,{taskCount:0}),i}catch(t){this._logger.error(this.component,t)}}},e.prototype._decrementTask=function(t){var e=this._spansData.get(t);e&&(e.taskCount--,0===e.taskCount&&this._tryToEndSpan(t,e.hrTimeLastTimeout))},e.prototype._getCurrentSpan=function(t){var e=t.get("OT_ZONE_CONTEXT");return e?i(e):e},e.prototype._incrementTask=function(t){var e=this._spansData.get(t);e&&e.taskCount++},e.prototype.addPatchedListener=function(t,e,r,n){var o=this._wrappedListeners.get(r);o||(o=new Map,this._wrappedListeners.set(r,o));var i=o.get(e);return i||(i=new Map,o.set(e,i)),!i.has(t)&&(i.set(t,n),!0)},e.prototype.removePatchedListener=function(t,e,r){var n=this._wrappedListeners.get(r);if(n){var o=n.get(e);if(o){var i=o.get(t);return i&&(o.delete(t),0===o.size&&(n.delete(e),0===n.size&&this._wrappedListeners.delete(r))),i}}},e.prototype._invokeListener=function(t,e,r){return"function"==typeof t?t.apply(e,r):t.handleEvent(r[0])},e.prototype._patchElement=function(){var t=this;return function(e){return function(r,n,o){var i=this,a=o&&o.once,s=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var s,u=i,c=e[0];c&&(s=t._eventsSpanMap.get(c)),a&&t.removePatchedListener(i,r,n);var p=t._createSpan(u,r,s);return p?(c&&t._eventsSpanMap.set(c,p),t._tracer.withSpan(p,(function(){var r=t._invokeListener(n,u,e);return p.end(),r}))):t._invokeListener(n,u,e)};if(t.addPatchedListener(this,r,n,s))return e.call(this,r,s,o)}}},e.prototype._patchRemoveEventListener=function(){var t=this;return function(e){return function(r,n,o){var i=t.removePatchedListener(this,r,n);return i?e.call(this,r,i,o):e.call(this,r,n,o)}}},e.prototype._patchHistoryApi=function(){this._unpatchHistoryApi(),nr.wrap(history,"replaceState",this._patchHistoryMethod()),nr.wrap(history,"pushState",this._patchHistoryMethod()),nr.wrap(history,"back",this._patchHistoryMethod()),nr.wrap(history,"forward",this._patchHistoryMethod()),nr.wrap(history,"go",this._patchHistoryMethod())},e.prototype._patchHistoryMethod=function(){var t=this;return function(e){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=""+location.pathname+location.hash+location.search,i=e.apply(this,r),a=""+location.pathname+location.hash+location.search;return o!==a&&t._updateInteractionName(a),i}}},e.prototype._unpatchHistoryApi=function(){se(history.replaceState)&&nr.unwrap(history,"replaceState"),se(history.pushState)&&nr.unwrap(history,"pushState"),se(history.back)&&nr.unwrap(history,"back"),se(history.forward)&&nr.unwrap(history,"forward"),se(history.go)&&nr.unwrap(history,"go")},e.prototype._updateInteractionName=function(t){var e=this._tracer.getCurrentSpan();e&&"function"==typeof e.updateName&&e.updateName("Navigation: "+t)},e.prototype._patchZoneCancelTask=function(){var t=this;return function(e){return function(r){var n=Zone.current,o=t._getCurrentSpan(n);return o&&t._shouldCountTask(r,n)&&t._decrementTask(o),e.call(this,r)}}},e.prototype._patchZoneScheduleTask=function(){var t=this;return function(e){return function(r){var n=Zone.current,o=t._getCurrentSpan(n);return o&&t._shouldCountTask(r,n)&&(t._incrementTask(o),t._checkForTimeout(r,o)),e.call(this,r)}}},e.prototype._patchZoneRunTask=function(){var t=this;return function(e){return function(r,n,o){var i,a=r.target,s=this;if(a){if(i=t._createSpan(a,r.eventName))return t._incrementTask(i),s.run((function(){try{return t._tracer.withSpan(i,(function(){var t=Zone.current;return r._zone=t,e.call(t,r,n,o)}))}finally{t._decrementTask(i)}}))}else i=t._getCurrentSpan(s);try{return e.call(s,r,n,o)}finally{i&&t._shouldCountTask(r,s)&&t._decrementTask(i)}}}},e.prototype._shouldCountTask=function(t,e){if(t._zone&&(e=t._zone),!e||!t.data||t.data.isPeriodic)return!1;var r=this._getCurrentSpan(e);return!!r&&(!!this._spansData.get(r)&&("macroTask"===t.type||"microTask"===t.type))},e.prototype._tryToEndSpan=function(t,e){t&&(this._spansData.get(t)&&(t.end(e),this._spansData.delete(t)))},e.prototype.patch=function(){var t=this.getZoneWithPrototype();return this._logger.debug("applying patch to",this.moduleName,this.version,"zone:",!!t),t?(se(t.prototype.runTask)&&(nr.unwrap(t.prototype,"runTask"),this._logger.debug("removing previous patch from method runTask")),se(t.prototype.scheduleTask)&&(nr.unwrap(t.prototype,"scheduleTask"),this._logger.debug("removing previous patch from method scheduleTask")),se(t.prototype.cancelTask)&&(nr.unwrap(t.prototype,"cancelTask"),this._logger.debug("removing previous patch from method cancelTask")),this._zonePatched=!0,nr.wrap(t.prototype,"runTask",this._patchZoneRunTask()),nr.wrap(t.prototype,"scheduleTask",this._patchZoneScheduleTask()),nr.wrap(t.prototype,"cancelTask",this._patchZoneCancelTask())):(this._zonePatched=!1,se(HTMLElement.prototype.addEventListener)&&(nr.unwrap(HTMLElement.prototype,"addEventListener"),this._logger.debug("removing previous patch from method addEventListener")),se(HTMLElement.prototype.removeEventListener)&&(nr.unwrap(HTMLElement.prototype,"removeEventListener"),this._logger.debug("removing previous patch from method removeEventListener")),nr.wrap(HTMLElement.prototype,"addEventListener",this._patchElement()),nr.wrap(HTMLElement.prototype,"removeEventListener",this._patchRemoveEventListener())),this._patchHistoryApi(),this._moduleExports},e.prototype.unpatch=function(){var t=this.getZoneWithPrototype();this._logger.debug("removing patch from",this.moduleName,this.version,"zone:",!!t),t&&this._zonePatched?(nr.unwrap(t.prototype,"runTask"),nr.unwrap(t.prototype,"scheduleTask"),nr.unwrap(t.prototype,"cancelTask")):(nr.unwrap(HTMLElement.prototype,"addEventListener"),nr.unwrap(HTMLElement.prototype,"removeEventListener")),this._unpatchHistoryApi()},e.prototype.getZoneWithPrototype=function(){return window.Zone},e}(dt);const dr={click:!0,dblclick:!0,submit:!0,reset:!0,dragend:!0,drop:!0,ended:!0,pause:!0,play:!0,change:!0,mousedown:!0,mouseup:!0};class lr extends fr{getZoneWithPrototype(){}_allowEventType(t){return dr[t]}emitRouteChangeSpan(t){const e=window.SplunkRum.provider.getTracer("route").startSpan("routeChange");e.setAttribute("component",this.moduleName),e.setAttribute("prev.href",t),e.end(e.startTime)}patch(){const t=this;return window.addEventListener("hashchange",(function(e){t.emitRouteChangeSpan(e.oldURL)})),super.patch()}_patchHistoryMethod(){const t=this;return e=>function(...r){const n=location.href,o=e.apply(this,r);return n!==location.href&&t.emitRouteChangeSpan(n),o}}}var _r,vr;!function(t){t.CLIENT="CLIENT",t.SERVER="SERVER",t.CONSUMER="CONSUMER",t.PRODUCER="PRODUCER"}(_r||(_r={}));var gr=((vr={})[G.CLIENT]=_r.CLIENT,vr[G.SERVER]=_r.SERVER,vr[G.CONSUMER]=_r.CONSUMER,vr[G.PRODUCER]=_r.PRODUCER,vr[G.INTERNAL]=void 0,vr);function mr(t,e,r,n,o){for(var i={},a=0,s=Object.keys(t);a<s.length;a++){var u=s[a];i[u]=String(t[u])}return i[r]=String(B[e.code]),e.message&&(i[n]=e.message),Object.keys(o.attributes).forEach((function(t){return i[t]=String(o.attributes[t])})),i}function Er(t){return"x".repeat(t/4).replace(/x/g,(function(){return(16*Math.random()|0).toString(16)}))}function yr(t,e){return t.length>e?t.substring(0,e):t}class Tr{constructor(t){this.beaconUrl=t}export(t,e){const r=t.map(t=>this.modZipkinSpan(t)),n=JSON.stringify(r);navigator.sendBeacon&&navigator.sendBeacon(this.beaconUrl,n),e({code:Ot.SUCCESS})}shutdown(){}modZipkinSpan(t){t.resource={attributes:{}};const e=function(t,e,r,n){var o;return{traceId:t.spanContext.traceId,parentId:t.parentSpanId,name:t.name,id:t.spanContext.spanId,kind:gr[t.kind],timestamp:Ut(t.startTime),duration:Ut(t.duration),localEndpoint:{serviceName:e},tags:mr(t.attributes,t.status,r,n,t.resource),annotations:t.events.length?(o=t.events,o.map((function(t){return{timestamp:Ut(t.time),value:t.name}}))):void 0}}(t,"browser","ot.status_code","ot.status_description");return delete e.localEndpoint,function(t){t.name=yr(t.name,4096);for(const[e,r]of Object.entries(t.tags))t.tags[e]=yr(r,4096)}(e),e}}function Sr(t){return t&&""!==t.trim()&&!t.startsWith("[object")&&"error"!==t}function wr(t,e){e&&e.stack&&Sr(e.stack)&&t.setAttribute("error.stack",yr(e.stack.toString(),4096))}class br{constructor(t){this.tracer=t}reportError(t,e){const r=e.message||e.toString();if(!Sr(r)&&!e.stack)return;const n=this.tracer.startSpan(t);n.setAttribute("component","error"),n.setAttribute("error",!0),n.setAttribute("error.object",Sr(e.name)?e.name:e.constructor&&e.constructor.name?e.constructor.name:"Error"),n.setAttribute("error.message",yr(r,1024)),wr(n,e),n.end(n.startTime)}reportString(t,e,r){if(!Sr(e))return;const n=this.tracer.startSpan(t);n.setAttribute("component","error"),n.setAttribute("error",!0),n.setAttribute("error.object","String"),n.setAttribute("error.message",yr(e,1024)),r&&wr(n,r),n.end(n.startTime)}reportErrorEvent(t,e){e.error?this.report(t,e.error):e.message&&this.report(t,e.message)}reportEvent(t,e){if(!e.target&&!Sr(e.type))return;const r=this.tracer.startSpan(t);r.setAttribute("component","error"),r.setAttribute("error.type",e.type),e.target&&(r.setAttribute("target_element",e.target.tagName),r.setAttribute("target_xpath",Ge(e.target,!0)),r.setAttribute("target_src",e.target.src)),r.end(r.startTime)}report(t,e){if(e&&0!==e.length)if(e instanceof Array&&1===e.length&&(e=e[0]),e instanceof Error)this.reportError(t,e);else if(e instanceof ErrorEvent)this.reportErrorEvent(t,e);else if(e instanceof Event)this.reportEvent(t,e);else if("string"==typeof e)this.reportString(t,e);else if(e instanceof Array){const r=e.find(t=>t instanceof Error);this.reportString(t,e.map(t=>t.toString()).join(" "),r)}else this.reportString(t,e.toString())}}function Rr(t,e){const r=e.getTracer("error"),n=new br(r);!function(t){window.addEventListener("error",(function(e){t.report("onerror",e)}))}(n),function(t){nr.wrap(console,"error",(function(e){return function(){return t.report("console.error",Array.from(arguments)),e.apply(this,arguments)}}))}(n),function(t){window.addEventListener("unhandledrejection",(function(e){t.report("unhandledrejection",e.reason)}))}(n),function(t){document.documentElement.addEventListener("error",(function(e){t.report("eventListener.error",e)}),{capture:!0})}(n),t.error=function(){n.report("SplunkRum.error",Array.from(arguments))}}var Nr="0.0.12";function Or(t){return t.byteLength||t.size||t.length||void 0}class Ar{constructor(t,e={}){this._tracer=t.getTracer("websocket"),this.listener2ws2patched=new WeakMap,this._config=e}startSpan(t,e,r){const n=this._tracer.startSpan(e,{kind:r});return n.setAttribute("component","websocket"),n.setAttribute("protocol",t.protocol),n.setAttribute("http.url",t.url),n}patchSend(t){const e=this,r=t.send;t.send=function(){const n=e.startSpan(t,"send",G.PRODUCER),o=arguments.length>0?Or(arguments[0]):void 0;n.setAttribute("http.request_content_length",o);let i=void 0;try{i=r.apply(t,arguments)}catch(t){throw e.endSpanExceptionally(n,t),t}return!1===i&&n.setAttribute("error",!0),n.end(),i}}addPatchedListener(t,e,r){let n=this.listener2ws2patched.get(e);return n||(n=new Map,this.listener2ws2patched.set(e,n)),!n.has(t)&&(n.set(t,r),!0)}removePatchedListener(t,e){const r=this.listener2ws2patched.get(e);if(!r)return;const n=r.get(t);return n&&(r.delete(t),0===r.size&&this.listener2ws2patched.delete(t)),n}patchEventListener(t){const e=this,r=t.addEventListener;t.addEventListener=function(n,o,i){if("message"!==n)return void r.apply(t,arguments);const a=i&&i.once,s=function(){const r=this,n=arguments;a&&e.removePatchedListener(t,o);const i=e.startSpan(t,"onmessage",G.CONSUMER);return n&&n[0]&&n[0].data&&i.setAttribute("http.response_content_length",Or(n[0].data)),e._tracer.withSpan(i,()=>{let t=void 0;return t="function"==typeof o?o.apply(r,n):o.handleEvent(arguments[0]),i.end(),t})};e.addPatchedListener(t,o,s)&&r.apply(t,[n,s,i])};const n=t.removeEventListener;t.removeEventListener=function(r,o){if("message"!==r)return n.apply(t,arguments);const i=e.removePatchedListener(t,o);return i?n.apply(t,[r,i]):n.apply(t,arguments)}}endSpanExceptionally(t,e){console.log("endSpanExceptionally"),t.setAttribute("error",!0),t.setAttribute("error.message",e.message),t.setAttribute("error.object",e.name?e.name:e.constructor&&e.constructor.name?e.constructor.name:"Error"),t.end()}patch(){const t=this;nr.wrap(window,"WebSocket",(function(e){return function(r,n){if(ae(r,t._config.ignoreUrls))return new e(r,n);let o=t._tracer.startSpan("connect");o.kind=G.CLIENT,o.setAttribute("component","websocket"),r&&o.setAttribute("http.url",arguments[0]),n&&("string"==typeof n?o.setAttribute("protocols",n):o.setAttribute("protocols",JSON.stringify(n)));let i=void 0,a=void 0;try{i=new e(r,n)}catch(t){a=t}if(a)throw t.endSpanExceptionally(o,a),o=void 0,a;{const e=i;return e.addEventListener("open",(function(){o.end(),o=void 0})),e.addEventListener("error",(function(r){o?(r.error?t.endSpanExceptionally(o,r.error):(o.setAttribute("error",!0),o.setAttribute("error.message",r.message),o.end()),o=void 0):(t.startSpan(e,"error"),t.endSpanExceptionally(o,r.error))})),t.patchSend(e),t.patchEventListener(e),i}}}))}}window.SplunkRum||(window.SplunkRum={inited:!1},window.SplunkRum.init=function(t){if(this.inited)return void console.log("SplunkRum already init()ed.");if(!t.debug){if(!t.beaconUrl)throw new Error("SplunkRum.init( {beaconUrl: 'https://something'} ) is required.");if(!t.beaconUrl.startsWith("https")&&!t.allowInsecureBeacon)throw new Error("Not using https is unsafe, if you want to force it use allowInsecureBeacon option.");t.rumAuth||console.log("rumAuth will be required in the future")}const e=t.app||"unknown-browser-app",r=Er(64),n="_splunk_rum_sid";let o=void 0;const i=function(){if(!document.cookie.includes(n)){const t=Er(128);document.cookie=n+"="+t+"; path=/; max-age=86400",setTimeout(i,36e5)}o=function(t){const e=decodeURIComponent(document.cookie).split(";");for(let r=0;r<e.length;r++){const n=e[r].trim();if(0===n.indexOf(t+"="))return n.substring((t+"=").length,n.length)}}(n)};i();let a=t.globalAttributes&&"object"==typeof t.globalAttributes?t.globalAttributes:void 0;this.setGlobalAttributes=function(t){a="object"==typeof t?t:void 0};const s=t.ignoreUrls?{ignoreUrls:t.ignoreUrls}:{},u=[new Xe,new cr(s),new lr];window.PerformanceObserver&&u.push(new pr(s));const c=new class extends Me{getTracer(t,n,i){const s=super.getTracer(t,n,i),u=s.startSpan;return s.startSpan=function(){const t=u.apply(s,arguments);return t.setAttribute("location.href",location.href),t.setAttribute("splunk.rumSessionId",o),t.setAttribute("splunk.rumVersion",Nr),t.setAttribute("app",e),t.setAttribute("splunk.scriptInstance",r),a&&t.setAttributes(a),t},s}}({plugins:u,logLevel:t.debug?et.DEBUG:et.ERROR});if(new Ar(c,s).patch(),t.beaconUrl){const e=t.beaconUrl+(t.rumAuth?"?auth="+t.rumAuth:""),r=new Le(new Tr(e),{bufferTimeout:100,bufferSize:20});window.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&r.forceFlush()})),c.addSpanProcessor(r)}t.debug&&c.addSpanProcessor(new De(new Ce)),c.register(),Object.defineProperty(this,"provider",{value:c,configurable:!0}),void 0===t.captureErrors||!0===t.captureErrors?Rr(this,c):this.error=function(){},this.inited=!0,console.log("SplunkRum.init() complete")})}();
</script>
<script>
    window.SplunkRum && window.SplunkRum.init(
        { beaconUrl: 'http://127.0.0.1:9080/api/v2/spans', debug:true, allowInsecureBeacon: true, });
</script>
<p>Hi!</p>

<script>
console.log("hello");

function whenDone() {
  console.log("whenDone");
}

function throwit() {
  throw new Error('oh no');
}

function go() {
  console.log("go");
  var oReq = new XMLHttpRequest();
  oReq.addEventListener("load", whenDone);
  oReq.open("GET", location.href, true);
  oReq.setRequestHeader('Cache-Control', 'no-cache');
  oReq.send();

  fetch(location.href).then(function(response) {
   console.log('fetch finished');
  });

  // causes unhandledrejection
  Promise.resolve('ok').then(() => { throw new Error('pancakes!'); });

  // 'normal' error chain
  throwit();
}


setTimeout(go, 2000);

function clicky() {
	console.log('clicky');
}

</script>

<a href="javascript:go()">Go again</a>
<a id="route" href="javascript:clicky()">Change name</a>
<a id="routeAfterFetch" href="javascript:clicky()">Change name after fetch</a>

<script>
document.getElementById("route").addEventListener('click', function() {
  history.pushState({}, 'title', '/thisIsArtificiallySet');
});
</script>

<script>
document.getElementById("routeAfterFetch").addEventListener('click', function() {
  fetch('page2.html').then(function(response) {
    history.pushState({}, 'title', '/thisIsSetAfterFetch');
  });
});
</script>

<img src="./doesnotexist.jpg">

</html>
